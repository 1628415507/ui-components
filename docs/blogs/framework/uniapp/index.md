# 小程序

## 【小程序与 H5 的区别有如下】

- 运行环境:小程序基于浏览器内核重构的内置解析器；
- 系统权限:小程序能获得更多的**系统权限**，如网络通信状态、数据缓存能力等；
- 渲染机制:小程序的逻辑层和渲染层是**分开**的

## 【小程序的优缺点】

- 优点
  - 随搜随用，用完即走:使得小程序可以代替许多 APP，或是做 APP 的整体嫁接，或是作为阉割版功能的承载体
  - 流量大，易接受:小程序借助自身平台更加容易引入更多的流量
  - 安全
  - 开发门槛低
  - 降低兼容性限制
- 缺点:
  - 用户留存:及相关数据显示，小程序的平均次日留存在 13%左右，但是双周留存骤降到仅有 1%。
  - **体积限制**:微信小程序只有 2M 的大小，这样导致无法开发大型一些的小程序
  - **受控微信**:比起 APP，尤其是安卓版的高自由度，小程序要面对很多来自微信的限制，从功能接口，甚至到类别内容，都要接受微信的管控

## 【小程序的生命周期】

小程序中，生命周期主要分成了三部分:应用的生命周期、页面的生命周期、组件的生命周期

### 1.应用的生命周期

- 启动或退出小程序时触发

#### 1-1.生命周期有哪些

![alt text](image.png)
| 生命周期 | 说明 |
| ---------- | -------------------- |
| `onLaunch` | 小程序初始化完成时触发，全局只触发一次 |
| `onShow` | 小程序启动，或从后台进入前台显示时触发 |
| `onHide` | 小程序从前台进入后台，退出小程序时触发 |
| onError | 小程序发生脚本错误或 API 调用报错时触发 |
| onPageNotFound | 小程序要打开的页面不存在时触发 |
| onUnhandledRejection | 小程序有未处理的 Promise 拒绝时触发 |
| onThemeChange | 系统切换主题时触发 |

#### 1-2.应用的生命周期执行过程:

- 用户首次打开小程序，触发 `onLaunch`(全局只触发一次)
- 小程序初始化完成后，触发`onShow`方法，监听小程序显示
- 小程序从前台进入后台，触发 `onHide` 方法
- 小程序从后台进入前台显示，触发 `onShow` 方法
- 小程序后台运行一定时间，或系统资源占用过高，会被销毁

### 2.页面的生命周期

切换页面时触发

#### 2-1.页面的生命周期有哪些

| 生命周期 | 说明                               | 适用场景                       |
| -------- | ---------------------------------- | ------------------------------ |
| onLoad   | 生命周期回调一监听页面加载         | 发送请求获取数据               |
| onShow   | 生命周期回调一监听页面显示         | 请求数据                       |
| onReady  | 生命周期回调一监听页面初次渲染完成 | 获取页面元素(少用)             |
| onHide   | 生命周期回调一监听页面隐藏         | 终止任务，如定时器或者播放音乐 |
| onUnload | 生命周期回调一监听页面卸载         | 终止任务                       |

#### 2-2.页面生命周期的执行过程:

- 小程序注册完成后，加载页面，触发 `onLoad` 方法
- 页面载入后触发 `onShow` 方法，显示页面
- **首次显示页面**，会触发 `onReady` 方法，渲染页面元素和样式，**一个页面只会调用一次**
- 当小程序后台运行或跳转到其他页面时(即离开当前页面时)，触发 `onHide` 方法.
- 当小程序由后台进入到前台运行或重新进入页面时，触发 `onShow` 方法
- 当使用**重定向**方法`wx.redirectTo()`或**关闭**当前页**返回上一页** `wx.navigateBack()`，触发 `onUnload`
- 当存在也应用生命周期和页面周期的时候，相关的执行顺序如下:
  - 打开小程序:`(App)onLaunch -->(App)onShow -->(Pages)onLoad -->(Pages)onShow -->(Pages)onRead`
  - 进入下一个页面:`(Pages)onHide -->(Next)onLoad -->(Next)onShow -->(Next)onReady`
  - 返回上一个页面:`(curr)onUnload -->(pre)onShow`
  - 离开小程序:`(App)onHide`
  - 再次进入:
    - 小程序未销毁 -->`(App)onShow`(执行上面的顺序)，
    - 小程序被销毁`(App)onLaunch` 重新开始执行.

### 3.组件的生命周期

#### 3-1.组件的生命周期有哪些

| 生命周期   | 说明                               |
| ---------- | ---------------------------------- |
| `created`  | 生命周期回调一监听页面加载         |
| `attached` | 生命周期回调一监听页面显示         |
| `ready`    | 生命周期回调一监听页面初次渲染完成 |
| `moved`    | 生命周期回调一监听页面隐藏         |
| detached   | 生命周期回调一监听页面卸载         |
| error      | 每当组件方法抛出错误时执行         |

## uni-app 如何引入其他复杂的包方法

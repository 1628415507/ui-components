## 【使⽤ canvas 实现电影院选票功能】

- `canvas.getContext('2d')`：
  - getContext 方法指定参数 `2d` ，表示该 canvas 节点用于生成 2D 图案（即平面图案）。
  - 如果参数是 webgl，就表示用于生成 3D 图像（即立体图案）
- canvas 画布提供了一个用来作图的平面空间，该空间的每个点都有自己的坐标，x 表示横坐标，y 表示竖坐标。
  - **原点(0, 0)位于图像左上角**，**x 轴的正向是原点向右，y 轴的正向是原点向下**。
- `fillRect(x, y, width, height)`方法用来绘制矩形，它的四个参数分别为矩形左上角顶点的 x 坐标、y 坐标，以及矩形的宽和高。
- `fillStyle` 属性用来设置矩形的填充色。( `ctx.fillStyle = '#42b983'`)
  ::: example
  blogs/css/html/moviesCanvas
  :::

## 【为何现在市⾯上做表格渲染可视化技术的，⼤多数都是 canvas ， ⽽很少⽤ svg 的？】

都⽤上了可视化技术做渲染， 在这个场景下， ⼤多数考虑的是性能；
所以主要基于⼏个⽅⾯去衡量技术⽅案的选择： 性能、动态交互、复杂图形⽀持

| 区别         | Canvas                                             | SVG                                           | 结论                             |
| ------------ | -------------------------------------------------- | --------------------------------------------- | -------------------------------- |
| 性能         | 基于**像素**的绘图技术                             | 基于 **⽮量**的绘图技术                       | Canvas 通常⽐ SVG 具有更好的性能 |
| 动态交互     | 直接操作像素                                       | 由 DOM 元素组成的，每个元素都要进⾏布局和绘制 | Canvas 更适合处理动态交互        |
| 复杂图形⽀持 | 可以实现更加灵活和复杂的图形效果，⽐如阴影、渐变等 | 对复杂图形的⽀持可能会有⼀些限制              | Canvas 更适合处理复杂的图形      |

- 性能：Canvas 通常⽐ SVG 具有更好的性能。
  - Canvas 是基于**像素**的绘图技术，⽽ SVG 是基于 **⽮量**的绘图技术。
  - 由于 Canvas 的绘图是**直接操作像素**，所以在⼤规模绘制⼤量图形时，Canvas 的性能优势更为明显。  
    ⽽ SVG ⽣成的图形是由 `DOM` 元素组成，每个元素都要进⾏布局和绘制，因此在处理⼤量图形时会有性能瓶颈。
- 动态交互：Canvas 更适合处理动态交互。
  - 由于 Canvas 绘制的图形是像素级别的，**可以直接对图形进⾏像素级别的操作**，可以⽅便地进⾏复杂的动画和交互效果。
  - ⽽ SVG 的图形是由 DOM 元素组成的，每个元素都要进⾏布局和绘制，所以在处理复杂的动态交互时，性能⽅⾯可能会受到限制。
- 复杂图形⽀持：Canvas 更适合处理复杂的图形。
  - 由于 Canvas 是像素级别的绘制，可以直接操作像素，因此**可以实现更加灵活和复杂的图形效果，⽐如阴影、渐变等**。
  - ⽽ SVG 的图形是基于⽮量的，相对来说对复杂图形的⽀持可能会有⼀些限制。

### canvas 和 svg 在动态交互上有什么具体的区别？

- 元素操作：**在 Canvas 中，绘制的图形被视为位图，⽆法直接访问和操作单个元素**，需要通过
  `JavaScript` 对整个画布进⾏操作。
- ⽽在 SVG 中，每个图形元素都是 DOM 元素，可以直接访问和操作单个元素，⽐如修改属性、绑定事件等。

真实场景： ⽐如在 table 开发场景下，**svg 能通过元素进⾏事件绑定进⾏⽤⼾操作事件驱动**， ⽐较⽅
便， 但是同样的⽤⼾操作， ⽤ canvas 去驱动， 显得并不是那么的⽅便。

### 这个问题 canvas 是如何解 决的？

- 在 Table 开发场景下，SVG 确实更适合进⾏事件绑定和⽤⼾操作事件驱动。使⽤ SVG，可以直接操作每个图形元素，为其绑定事件处理程序，实现⽤⼾交互。
- ⽽ Canvas 在处理⽤⼾操作事件驱动⽅⾯相对不太⽅便，因为 Canvas 绘制的是位图，**并不直接⽀持事件绑定**。但是可以通过以下⽅式解决这个问题：
  • 通过将 Canvas 元素放置在 HTML 元素之上，再利⽤ CSS 控制其位置和尺⼨，实现与⽤⼾交互的感
  觉。然后通过监听 HTML 元素的事件，通过 JavaScript 判断⽤⼾操作的位置与 Canvas 上的图形元
  素是否相交，从⽽模拟出⽤⼾交互的效果。
  • 使⽤第三⽅库或框架，如 Fabric.js、Konva.js 等，它们提供了更⾼级的 API 和事件系统，
  使得在 Canvas 上进⾏⽤⼾交互更加⽅便。这些库可以处理⽤⼾操作事件，检测点击、拖拽、缩放
  等交互操作，并提供了事件绑定和管理的⽅法。
  通过以上⽅式，可以在 Canvas 中实现⼀些基本的⽤⼾交互，但相⽐于 SVG 来说，Canvas 的事件处理
  和⽤⼾交互仍然相对繁琐⼀些。所以在需要⼤量的⽤⼾交互和事件处理的情况下，SVG 仍然是更好的
  选择。
  追问： canvas 如何更为⽅便的提供事件处理能⼒？因为 canvas 不能进⾏事件绑定等， 显得就
  ⾮常的不⽅便
  在 Canvas 中提供事件处理能⼒，可以通过以下两种⽅式更为⽅便：

1. 使⽤第三⽅库或框架：有⼀些流⾏的 Canvas 框架可以帮助简化事件处理，例如 Fabric.js、
   Konva.js 和 EaselJS 等。这些库封装了 Canvas 的底层 API，提供了更⾼级的事件系统和⽅法，可
   以轻松地为图形元素绑定事件处理程序，实现⽤⼾交互。
2. ⼿动实现事件处理：通过监听 HTML 元素的事件（例如⿏标点击、移动、滚轮等），再结合
   Canvas 的绘制和坐标计算，可以⼿动实现事件处理。以下是基本的步骤：
   ◦ 获取⿏标或触摸事件的坐标。
   ◦ 判断坐标是否在 Canvas 绘制区域内。
   ◦ 找到被点击的图形元素（如果有）。
   ◦ 根据事件类型执⾏相应的操作，如拖拽、缩放、点击等。
   追问: Fabric.js 是如何进⾏ canvas 底层事件 api 的封装的？
   Fabric.js 是⼀个强⼤的 Canvas 库，它在提供图形绘制和交互能⼒的同时，也封装了 Canvas 的
   底层事件 API，简化了事件处理的流程。下⾯是 Fabric.js 如何封装 Canvas 底层事件 API 的⼀
   些主要⽅式：
3. 事件监听： Fabric.js 提供了 on ⽅法，⽤于在 Canvas 上注册事件处理程序。可以监听各种
   事件，如⿏标点击、移动、滚动、键盘事件等。通过这个⽅法，可以为整个 Canvas 或图形元素
   绑定事件。
4. 事件对象：在事件处理程序中， Fabric.js 将底层事件对象进⾏封装，提供了⼀个更⾼级的事
   件对象（ fabric.Event ），其中包含了更多有⽤的信息，如事件类型、触发坐标、关联的图形
   对象等。
5. 坐标转换： Fabric.js 提供了⼀系列的⽅法来处理坐标转换，使得事件处理更加⽅便。可以通
   过 getPointer ⽅法获取相对于 Canvas 的坐标，通过 localToGlobal 和
   globalToLocal ⽅法在不同坐标系之间进⾏转换。
6. 交互操作： Fabric.js 提供了⼀些⽅便的⽅法来处理⽤⼾交互，如拖拽、缩放、旋转等。通过
   dragging 、 scaling 、 rotating 等属性和⽅法，可以轻松地实现这些交互操作，并在事
   件处理程序中进⾏相应的处理。
